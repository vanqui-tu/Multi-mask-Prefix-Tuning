Namespace(seed=None, subsetlr=0.05, lr=0.005, warmup_ratio=0.06, batch_size=32, step_batch_size=None, epoch=30, max_length=512, weight_decay=0, dataset_name='boolq', model_name_or_path='t5-base', tokenizer_name_or_path='t5-base', random_seed=42, method='prefix-routing', num_virtual_tokens=1, num_shared_virtual_tokens=10, num_virtual_tokens_full=2, routing_level='prompt', consistency_alpha=0.1, init_copy=True, perturb_router=1, topk=1, stochastic=False, gumbel=False, shareType='Only', sharedEmbeddinglr=0.005, routerlr=0.0005, apply_adaptive_mask=1, apply_adaptive_subset_mask=1)
lr=0.005 batch_size=32 epoch=30 num_virtual_tokens=1 random_seed=42
Formatting dataset:   0%|                                                  | 0/8483 [00:00<?, ?it/s]Formatting dataset:   1%|▌                                     | 120/8483 [00:00<00:07, 1191.17it/s]Formatting dataset:   3%|█                                     | 240/8483 [00:00<00:06, 1190.11it/s]Formatting dataset:   4%|█▋                                    | 364/8483 [00:00<00:06, 1209.48it/s]Formatting dataset:   6%|██▏                                   | 489/8483 [00:00<00:06, 1224.94it/s]Formatting dataset:   7%|██▋                                   | 613/8483 [00:00<00:06, 1222.14it/s]Formatting dataset:   9%|███▎                                  | 738/8483 [00:00<00:06, 1228.93it/s]Formatting dataset:  10%|███▊                                  | 863/8483 [00:00<00:06, 1234.23it/s]Formatting dataset:  12%|████▍                                 | 987/8483 [00:00<00:06, 1210.45it/s]Formatting dataset:  13%|████▊                                | 1109/8483 [00:00<00:06, 1195.55it/s]Formatting dataset:  15%|█████▍                               | 1233/8483 [00:01<00:06, 1205.98it/s]Formatting dataset:  16%|█████▉                               | 1354/8483 [00:01<00:06, 1164.22it/s]Formatting dataset:  17%|██████▍                              | 1471/8483 [00:01<00:06, 1163.83it/s]Formatting dataset:  19%|██████▉                              | 1593/8483 [00:01<00:05, 1178.27it/s]Formatting dataset:  20%|███████▍                             | 1714/8483 [00:01<00:05, 1186.70it/s]Formatting dataset:  22%|███████▉                             | 1833/8483 [00:01<00:05, 1183.49it/s]Formatting dataset:  23%|████████▌                            | 1952/8483 [00:01<00:05, 1182.32it/s]Formatting dataset:  24%|█████████                            | 2072/8483 [00:01<00:05, 1187.10it/s]Formatting dataset:  26%|█████████▌                           | 2191/8483 [00:01<00:05, 1180.93it/s]Formatting dataset:  27%|██████████                           | 2313/8483 [00:01<00:05, 1189.34it/s]Formatting dataset:  29%|██████████▌                          | 2434/8483 [00:02<00:05, 1193.28it/s]Formatting dataset:  30%|███████████▏                         | 2554/8483 [00:02<00:04, 1193.46it/s]Formatting dataset:  32%|███████████▋                         | 2674/8483 [00:02<00:05, 1151.33it/s]Formatting dataset:  33%|████████████▏                        | 2790/8483 [00:02<00:04, 1148.44it/s]Formatting dataset:  34%|████████████▋                        | 2907/8483 [00:02<00:04, 1153.08it/s]Formatting dataset:  36%|█████████████▏                       | 3023/8483 [00:02<00:04, 1146.55it/s]Formatting dataset:  37%|█████████████▋                       | 3143/8483 [00:02<00:04, 1160.51it/s]Formatting dataset:  38%|██████████████▏                      | 3265/8483 [00:02<00:04, 1176.35it/s]Formatting dataset:  40%|██████████████▊                      | 3383/8483 [00:02<00:04, 1152.70it/s]Formatting dataset:  41%|███████████████▎                     | 3499/8483 [00:02<00:04, 1151.70it/s]Formatting dataset:  43%|███████████████▊                     | 3621/8483 [00:03<00:04, 1171.06it/s]Formatting dataset:  44%|████████████████▎                    | 3743/8483 [00:03<00:04, 1183.79it/s]Formatting dataset:  46%|████████████████▊                    | 3862/8483 [00:03<00:03, 1183.13it/s]Formatting dataset:  47%|█████████████████▎                   | 3981/8483 [00:03<00:03, 1177.58it/s]Formatting dataset:  48%|█████████████████▉                   | 4103/8483 [00:03<00:03, 1187.43it/s]Formatting dataset:  50%|██████████████████▍                  | 4222/8483 [00:03<00:03, 1178.66it/s]Formatting dataset:  51%|██████████████████▉                  | 4340/8483 [00:03<00:03, 1155.04it/s]Formatting dataset:  53%|███████████████████▍                 | 4456/8483 [00:03<00:03, 1152.77it/s]Formatting dataset:  54%|███████████████████▉                 | 4581/8483 [00:03<00:03, 1179.68it/s]Formatting dataset:  55%|████████████████████▍                | 4700/8483 [00:03<00:03, 1168.97it/s]Formatting dataset:  57%|█████████████████████                | 4817/8483 [00:04<00:03, 1163.46it/s]Formatting dataset:  58%|█████████████████████▌               | 4939/8483 [00:04<00:03, 1176.53it/s]Formatting dataset:  60%|██████████████████████               | 5058/8483 [00:04<00:02, 1179.11it/s]Formatting dataset:  61%|██████████████████████▌              | 5176/8483 [00:04<00:02, 1170.44it/s]Formatting dataset:  62%|███████████████████████              | 5294/8483 [00:04<00:02, 1161.49it/s]Formatting dataset:  64%|███████████████████████▌             | 5412/8483 [00:04<00:02, 1163.92it/s]Formatting dataset:  65%|████████████████████████             | 5530/8483 [00:04<00:02, 1167.88it/s]Formatting dataset:  67%|████████████████████████▋            | 5647/8483 [00:04<00:02, 1147.93it/s]Formatting dataset:  68%|█████████████████████████▏           | 5767/8483 [00:04<00:02, 1159.42it/s]Formatting dataset:  69%|█████████████████████████▋           | 5889/8483 [00:05<00:02, 1176.60it/s]Formatting dataset:  71%|██████████████████████████▏          | 6016/8483 [00:05<00:02, 1203.86it/s]Formatting dataset:  72%|██████████████████████████▊          | 6137/8483 [00:05<00:01, 1197.41it/s]Formatting dataset:  74%|███████████████████████████▎         | 6257/8483 [00:05<00:01, 1173.63it/s]Formatting dataset:  75%|███████████████████████████▊         | 6381/8483 [00:05<00:01, 1192.24it/s]Formatting dataset:  77%|████████████████████████████▎        | 6501/8483 [00:05<00:01, 1192.44it/s]Formatting dataset:  78%|████████████████████████████▉        | 6621/8483 [00:05<00:01, 1181.90it/s]Formatting dataset:  79%|█████████████████████████████▍       | 6740/8483 [00:05<00:01, 1166.79it/s]Formatting dataset:  81%|█████████████████████████████▉       | 6861/8483 [00:05<00:01, 1179.39it/s]Formatting dataset:  82%|██████████████████████████████▍      | 6984/8483 [00:05<00:01, 1192.76it/s]Formatting dataset:  84%|██████████████████████████████▉      | 7104/8483 [00:06<00:01, 1170.72it/s]Formatting dataset:  85%|███████████████████████████████▌     | 7223/8483 [00:06<00:01, 1173.31it/s]Formatting dataset:  87%|████████████████████████████████     | 7341/8483 [00:06<00:00, 1152.07it/s]Formatting dataset:  88%|████████████████████████████████▌    | 7458/8483 [00:06<00:00, 1155.68it/s]Formatting dataset:  89%|█████████████████████████████████    | 7574/8483 [00:06<00:00, 1146.67it/s]Formatting dataset:  91%|█████████████████████████████████▌   | 7689/8483 [00:06<00:00, 1123.91it/s]Formatting dataset:  92%|██████████████████████████████████   | 7806/8483 [00:06<00:00, 1135.96it/s]Formatting dataset:  93%|██████████████████████████████████▌  | 7925/8483 [00:06<00:00, 1151.74it/s]Formatting dataset:  95%|███████████████████████████████████  | 8041/8483 [00:06<00:00, 1150.73it/s]Formatting dataset:  96%|███████████████████████████████████▌ | 8157/8483 [00:06<00:00, 1123.63it/s]Formatting dataset:  98%|████████████████████████████████████▏| 8283/8483 [00:07<00:00, 1161.10it/s]Formatting dataset:  99%|████████████████████████████████████▋| 8406/8483 [00:07<00:00, 1176.25it/s]Formatting dataset: 100%|█████████████████████████████████████| 8483/8483 [00:07<00:00, 1174.15it/s]
Formatting dataset:   0%|                                                   | 0/944 [00:00<?, ?it/s]Formatting dataset:  13%|█████                                  | 122/944 [00:00<00:00, 1219.68it/s]Formatting dataset:  26%|██████████▏                            | 247/944 [00:00<00:00, 1232.18it/s]Formatting dataset:  39%|███████████████▎                       | 371/944 [00:00<00:00, 1205.48it/s]Formatting dataset:  53%|████████████████████▋                  | 500/944 [00:00<00:00, 1236.37it/s]Formatting dataset:  66%|█████████████████████████▊             | 624/944 [00:00<00:00, 1205.67it/s]Formatting dataset:  79%|██████████████████████████████▊        | 745/944 [00:00<00:00, 1189.29it/s]Formatting dataset:  92%|███████████████████████████████████▋   | 865/944 [00:00<00:00, 1166.94it/s]Formatting dataset: 100%|███████████████████████████████████████| 944/944 [00:00<00:00, 1184.15it/s]
Formatting dataset:   0%|                                                  | 0/3270 [00:00<?, ?it/s]Formatting dataset:   4%|█▍                                    | 119/3270 [00:00<00:02, 1183.60it/s]Formatting dataset:   7%|██▊                                   | 238/3270 [00:00<00:02, 1132.90it/s]Formatting dataset:  11%|████                                  | 352/3270 [00:00<00:02, 1123.35it/s]Formatting dataset:  14%|█████▍                                | 470/3270 [00:00<00:02, 1144.30it/s]Formatting dataset:  18%|██████▊                               | 588/3270 [00:00<00:02, 1155.75it/s]Formatting dataset:  22%|████████▏                             | 704/3270 [00:00<00:02, 1153.30it/s]Formatting dataset:  25%|█████████▌                            | 828/3270 [00:00<00:02, 1179.72it/s]Formatting dataset:  29%|███████████                           | 947/3270 [00:00<00:01, 1165.26it/s]Formatting dataset:  33%|████████████                         | 1064/3270 [00:00<00:01, 1165.66it/s]Formatting dataset:  36%|█████████████▍                       | 1184/3270 [00:01<00:01, 1175.95it/s]Formatting dataset:  40%|██████████████▋                      | 1302/3270 [00:01<00:01, 1176.97it/s]Formatting dataset:  43%|████████████████                     | 1420/3270 [00:01<00:01, 1176.77it/s]Formatting dataset:  47%|█████████████████▍                   | 1541/3270 [00:01<00:01, 1185.90it/s]Formatting dataset:  51%|██████████████████▊                  | 1662/3270 [00:01<00:01, 1189.72it/s]Formatting dataset:  54%|████████████████████▏                | 1781/3270 [00:01<00:01, 1169.87it/s]Formatting dataset:  58%|█████████████████████▍               | 1900/3270 [00:01<00:01, 1174.54it/s]Formatting dataset:  62%|██████████████████████▊              | 2018/3270 [00:01<00:01, 1165.48it/s]Formatting dataset:  65%|████████████████████████▏            | 2139/3270 [00:01<00:00, 1177.27it/s]Formatting dataset:  69%|█████████████████████████▌           | 2257/3270 [00:01<00:00, 1173.29it/s]Formatting dataset:  73%|██████████████████████████▊          | 2375/3270 [00:02<00:00, 1154.04it/s]Formatting dataset:  76%|████████████████████████████▏        | 2496/3270 [00:02<00:00, 1168.80it/s]Formatting dataset:  80%|█████████████████████████████▌       | 2615/3270 [00:02<00:00, 1173.42it/s]Formatting dataset:  84%|██████████████████████████████▉      | 2736/3270 [00:02<00:00, 1181.75it/s]Formatting dataset:  87%|████████████████████████████████▎    | 2855/3270 [00:02<00:00, 1181.12it/s]Formatting dataset:  91%|█████████████████████████████████▋   | 2974/3270 [00:02<00:00, 1172.00it/s]Formatting dataset:  95%|███████████████████████████████████  | 3094/3270 [00:02<00:00, 1179.93it/s]Formatting dataset:  98%|████████████████████████████████████▎| 3213/3270 [00:02<00:00, 1169.85it/s]Formatting dataset: 100%|█████████████████████████████████████| 3270/3270 [00:02<00:00, 1170.18it/s]
prompt_encoder.mask 240
prompt_encoder.embedding.weight 36864
prompt_encoder.sharedEmbedding.weight 184320
prompt_encoder.router.0.weight 1536
trainable params: 222960 || all params: 223105008 || trainable%: 0.09993500459657992
Train:   0%|                                                                | 0/266 [00:00<?, ?it/s]Train:   0%|▏                                                       | 1/266 [00:01<05:22,  1.22s/it]Train:   1%|▍                                                       | 2/266 [00:01<03:52,  1.14it/s]Train:   1%|▋                                                       | 3/266 [00:02<03:07,  1.41it/s]Train:   2%|▊                                                       | 4/266 [00:02<02:52,  1.52it/s]Train:   2%|█                                                       | 5/266 [00:04<03:34,  1.22it/s]Train:   2%|█▎                                                      | 6/266 [00:05<03:57,  1.09it/s]Train:   3%|█▍                                                      | 7/266 [00:05<03:45,  1.15it/s]Train:   3%|█▋                                                      | 8/266 [00:06<03:27,  1.25it/s]Train:   3%|█▉                                                      | 9/266 [00:07<03:20,  1.28it/s]Train:   4%|██                                                     | 10/266 [00:08<03:34,  1.19it/s]Train:   4%|██▎                                                    | 11/266 [00:08<03:23,  1.26it/s]Train:   5%|██▍                                                    | 12/266 [00:10<03:44,  1.13it/s]Train:   5%|██▋                                                    | 13/266 [00:10<03:17,  1.28it/s]Train:   5%|██▉                                                    | 14/266 [00:11<03:10,  1.33it/s]Train:   6%|███                                                    | 15/266 [00:12<03:23,  1.23it/s]Train:   6%|███▎                                                   | 16/266 [00:12<03:06,  1.34it/s]Train:   6%|███▌                                                   | 17/266 [00:13<02:52,  1.44it/s]Train:   7%|███▋                                                   | 18/266 [00:14<02:53,  1.43it/s]Train:   7%|███▉                                                   | 19/266 [00:14<02:43,  1.51it/s]Train:   8%|████▏                                                  | 20/266 [00:15<02:55,  1.40it/s]Train:   8%|████▎                                                  | 21/266 [00:16<02:50,  1.43it/s]Train:   8%|████▌                                                  | 22/266 [00:16<02:49,  1.44it/s]Train:   9%|████▊                                                  | 23/266 [00:17<02:41,  1.50it/s]Train:   9%|████▉                                                  | 24/266 [00:18<02:41,  1.50it/s]Train:   9%|█████▏                                                 | 25/266 [00:18<02:37,  1.53it/s]Train:  10%|█████▍                                                 | 26/266 [00:19<02:57,  1.35it/s]Train:  10%|█████▌                                                 | 27/266 [00:20<03:02,  1.31it/s]Train:  11%|█████▊                                                 | 28/266 [00:21<02:50,  1.40it/s]Train:  11%|█████▉                                                 | 29/266 [00:21<02:52,  1.38it/s]Train:  11%|██████▏                                                | 30/266 [00:22<02:46,  1.42it/s]Train:  12%|██████▍                                                | 31/266 [00:23<03:11,  1.23it/s]Train:  12%|██████▌                                                | 32/266 [00:24<03:31,  1.11it/s]Train:  12%|██████▊                                                | 33/266 [00:25<03:08,  1.24it/s]Train:  13%|███████                                                | 34/266 [00:25<02:42,  1.43it/s]Train:  13%|███████▏                                               | 35/266 [00:26<02:35,  1.48it/s]Train:  14%|███████▍                                               | 36/266 [00:27<02:52,  1.33it/s]Train:  14%|███████▋                                               | 37/266 [00:27<02:37,  1.46it/s]Train:  14%|███████▊                                               | 38/266 [00:28<02:56,  1.29it/s]Train:  15%|████████                                               | 39/266 [00:29<03:20,  1.13it/s]Train:  15%|████████▎                                              | 40/266 [00:30<03:05,  1.22it/s]Train:  15%|████████▍                                              | 41/266 [00:31<02:51,  1.31it/s]Train:  16%|████████▋                                              | 42/266 [00:31<02:49,  1.32it/s]Train:  16%|████████▉                                              | 43/266 [00:32<03:03,  1.21it/s]Train:  17%|█████████                                              | 44/266 [00:33<02:51,  1.30it/s]Train:  17%|█████████▎                                             | 45/266 [00:34<02:56,  1.25it/s]Train:  17%|█████████▌                                             | 46/266 [00:35<02:55,  1.25it/s]Train:  18%|█████████▋                                             | 47/266 [00:35<02:44,  1.33it/s]Train:  18%|█████████▉                                             | 48/266 [00:36<02:38,  1.38it/s]Train:  18%|██████████▏                                            | 49/266 [00:37<02:28,  1.46it/s]Train:  19%|██████████▎                                            | 50/266 [00:38<02:41,  1.34it/s]Train:  19%|██████████▌                                            | 51/266 [00:38<02:35,  1.38it/s]Train:  20%|██████████▊                                            | 52/266 [00:39<02:45,  1.29it/s]Train:  20%|██████████▉                                            | 53/266 [00:40<02:29,  1.43it/s]Train:  20%|███████████▏                                           | 54/266 [00:41<02:40,  1.32it/s]Train:  21%|███████████▎                                           | 55/266 [00:41<02:43,  1.29it/s]Train:  21%|███████████▌                                           | 56/266 [00:42<02:36,  1.34it/s]Train:  21%|███████████▊                                           | 57/266 [00:43<02:50,  1.22it/s]Train:  22%|███████████▉                                           | 58/266 [00:44<03:08,  1.10it/s]Train:  22%|████████████▏                                          | 59/266 [00:45<03:11,  1.08it/s]Train:  23%|████████████▍                                          | 60/266 [00:46<02:45,  1.24it/s]Train:  23%|████████████▌                                          | 61/266 [00:46<02:35,  1.32it/s]Train:  23%|████████████▊                                          | 62/266 [00:47<02:35,  1.31it/s]Train:  24%|█████████████                                          | 63/266 [00:48<02:22,  1.42it/s]Train:  24%|█████████████▏                                         | 64/266 [00:48<02:15,  1.49it/s]Train:  24%|█████████████▍                                         | 65/266 [00:49<02:26,  1.37it/s]Train:  25%|█████████████▋                                         | 66/266 [00:50<02:19,  1.43it/s]Train:  25%|█████████████▊                                         | 67/266 [00:50<02:11,  1.51it/s]Train:  26%|██████████████                                         | 68/266 [00:51<02:17,  1.44it/s]Train:  26%|██████████████▎                                        | 69/266 [00:52<02:17,  1.43it/s]Train:  26%|██████████████▍                                        | 70/266 [00:53<02:26,  1.34it/s]Train:  27%|██████████████▋                                        | 71/266 [00:53<02:10,  1.49it/s]Train:  27%|██████████████▉                                        | 72/266 [00:54<02:11,  1.47it/s]Train:  27%|███████████████                                        | 73/266 [00:55<02:37,  1.23it/s]Train:  28%|███████████████▎                                       | 74/266 [00:56<02:31,  1.26it/s]Train:  28%|███████████████▌                                       | 75/266 [00:57<02:49,  1.13it/s]Train:  29%|███████████████▋                                       | 76/266 [00:57<02:36,  1.22it/s]Train:  29%|███████████████▉                                       | 77/266 [00:58<02:26,  1.29it/s]Train:  29%|████████████████▏                                      | 78/266 [00:59<02:35,  1.21it/s]Train:  30%|████████████████▎                                      | 79/266 [01:00<02:20,  1.33it/s]Train:  30%|████████████████▌                                      | 80/266 [01:01<02:39,  1.17it/s]Train:  30%|████████████████▋                                      | 81/266 [01:01<02:22,  1.30it/s]Train:  31%|████████████████▉                                      | 82/266 [01:02<02:20,  1.31it/s]Train:  31%|█████████████████▏                                     | 83/266 [01:03<02:06,  1.44it/s]Train:  32%|█████████████████▎                                     | 84/266 [01:03<02:15,  1.34it/s]Train:  32%|█████████████████▌                                     | 85/266 [01:04<02:06,  1.43it/s]Train:  32%|█████████████████▊                                     | 86/266 [01:05<01:58,  1.51it/s]Train:  33%|█████████████████▉                                     | 87/266 [01:06<02:10,  1.37it/s]Train:  33%|██████████████████▏                                    | 88/266 [01:06<02:06,  1.40it/s]Train:  33%|██████████████████▍                                    | 89/266 [01:07<01:53,  1.56it/s]Train:  34%|██████████████████▌                                    | 90/266 [01:08<02:09,  1.36it/s]Train:  34%|██████████████████▊                                    | 91/266 [01:08<01:58,  1.47it/s]Train:  35%|███████████████████                                    | 92/266 [01:09<02:10,  1.33it/s]Train:  35%|███████████████████▏                                   | 93/266 [01:10<01:55,  1.50it/s]Train:  35%|███████████████████▍                                   | 94/266 [01:11<02:16,  1.26it/s]Train:  36%|███████████████████▋                                   | 95/266 [01:11<01:57,  1.45it/s]Train:  36%|███████████████████▊                                   | 96/266 [01:12<02:09,  1.31it/s]Train:  36%|████████████████████                                   | 97/266 [01:13<01:58,  1.43it/s]Train:  37%|████████████████████▎                                  | 98/266 [01:13<01:50,  1.52it/s]Train:  37%|████████████████████▍                                  | 99/266 [01:14<01:42,  1.64it/s]Train:  38%|████████████████████▎                                 | 100/266 [01:14<01:44,  1.59it/s]Train:  38%|████████████████████▌                                 | 101/266 [01:15<01:43,  1.60it/s]Train:  38%|████████████████████▋                                 | 102/266 [01:16<01:54,  1.43it/s]Train:  39%|████████████████████▉                                 | 103/266 [01:16<01:47,  1.52it/s]Train:  39%|█████████████████████                                 | 104/266 [01:17<01:50,  1.47it/s]Train:  39%|█████████████████████▎                                | 105/266 [01:18<01:43,  1.55it/s]Train:  40%|█████████████████████▌                                | 106/266 [01:18<01:40,  1.60it/s]Train:  40%|█████████████████████▋                                | 107/266 [01:19<01:41,  1.56it/s]Train:  41%|█████████████████████▉                                | 108/266 [01:19<01:36,  1.63it/s]Train:  41%|██████████████████████▏                               | 109/266 [01:20<01:36,  1.62it/s]Train:  41%|██████████████████████▎                               | 110/266 [01:21<01:37,  1.60it/s]Train:  42%|██████████████████████▌                               | 111/266 [01:22<01:51,  1.39it/s]Train:  42%|██████████████████████▋                               | 112/266 [01:22<01:55,  1.34it/s]Train:  42%|██████████████████████▉                               | 113/266 [01:23<01:45,  1.45it/s]Train:  43%|███████████████████████▏                              | 114/266 [01:24<01:45,  1.44it/s]Train:  43%|███████████████████████▎                              | 115/266 [01:24<01:41,  1.49it/s]Train:  44%|███████████████████████▌                              | 116/266 [01:25<01:32,  1.63it/s]Train:  44%|███████████████████████▊                              | 117/266 [01:26<01:54,  1.30it/s]Train:  44%|███████████████████████▉                              | 118/266 [01:26<01:42,  1.44it/s]Train:  45%|████████████████████████▏                             | 119/266 [01:27<01:39,  1.48it/s]Train:  45%|████████████████████████▎                             | 120/266 [01:28<01:55,  1.26it/s]Train:  45%|████████████████████████▌                             | 121/266 [01:29<01:48,  1.34it/s]Train:  46%|████████████████████████▊                             | 122/266 [01:30<02:03,  1.16it/s]Train:  46%|████████████████████████▉                             | 123/266 [01:31<02:03,  1.16it/s]Train:  47%|█████████████████████████▏                            | 124/266 [01:32<02:12,  1.07it/s]Train:  47%|█████████████████████████▍                            | 125/266 [01:33<02:05,  1.12it/s]Train:  47%|█████████████████████████▌                            | 126/266 [01:33<01:54,  1.22it/s]Train:  48%|█████████████████████████▊                            | 127/266 [01:34<02:05,  1.11it/s]Train:  48%|█████████████████████████▉                            | 128/266 [01:35<01:59,  1.16it/s]Train:  48%|██████████████████████████▏                           | 129/266 [01:36<02:06,  1.08it/s]Train:  49%|██████████████████████████▍                           | 130/266 [01:37<01:53,  1.20it/s]Train:  49%|██████████████████████████▌                           | 131/266 [01:37<01:40,  1.34it/s]Train:  50%|██████████████████████████▊                           | 132/266 [01:38<01:35,  1.40it/s]Train:  50%|███████████████████████████                           | 133/266 [01:39<01:28,  1.50it/s]Train:  50%|███████████████████████████▏                          | 134/266 [01:39<01:31,  1.44it/s]Train:  51%|███████████████████████████▍                          | 135/266 [01:40<01:25,  1.52it/s]Train:  51%|███████████████████████████▌                          | 136/266 [01:41<01:41,  1.28it/s]Train:  52%|███████████████████████████▊                          | 137/266 [01:42<01:42,  1.26it/s]Train:  52%|████████████████████████████                          | 138/266 [01:43<01:43,  1.24it/s]Train:  52%|████████████████████████████▏                         | 139/266 [01:44<01:41,  1.25it/s]Train:  53%|████████████████████████████▍                         | 140/266 [01:44<01:43,  1.21it/s]Train:  53%|████████████████████████████▌                         | 141/266 [01:45<01:33,  1.34it/s]Train:  53%|████████████████████████████▊                         | 142/266 [01:46<01:36,  1.29it/s]Train:  54%|█████████████████████████████                         | 143/266 [01:47<01:47,  1.15it/s]Train:  54%|█████████████████████████████▏                        | 144/266 [01:48<01:54,  1.06it/s]Train:  55%|█████████████████████████████▍                        | 145/266 [01:49<02:00,  1.00it/s]Train:  55%|█████████████████████████████▋                        | 146/266 [01:50<01:46,  1.12it/s]Train:  55%|█████████████████████████████▊                        | 147/266 [01:50<01:37,  1.22it/s]Train:  56%|██████████████████████████████                        | 148/266 [01:51<01:33,  1.27it/s]Train:  56%|██████████████████████████████▏                       | 149/266 [01:52<01:22,  1.42it/s]Train:  56%|██████████████████████████████▍                       | 150/266 [01:52<01:17,  1.49it/s]Train:  57%|██████████████████████████████▋                       | 151/266 [01:53<01:22,  1.40it/s]Train:  57%|██████████████████████████████▊                       | 152/266 [01:54<01:15,  1.52it/s]Train:  58%|███████████████████████████████                       | 153/266 [01:54<01:12,  1.55it/s]Train:  58%|███████████████████████████████▎                      | 154/266 [01:55<01:18,  1.42it/s]Train:  58%|███████████████████████████████▍                      | 155/266 [01:56<01:14,  1.49it/s]Train:  59%|███████████████████████████████▋                      | 156/266 [01:56<01:15,  1.45it/s]Train:  59%|███████████████████████████████▊                      | 157/266 [01:57<01:16,  1.43it/s]Train:  59%|████████████████████████████████                      | 158/266 [01:58<01:11,  1.51it/s]Train:  60%|████████████████████████████████▎                     | 159/266 [01:58<01:07,  1.58it/s]Train:  60%|████████████████████████████████▍                     | 160/266 [01:59<01:06,  1.60it/s]Train:  61%|████████████████████████████████▋                     | 161/266 [02:00<01:13,  1.42it/s]Train:  61%|████████████████████████████████▉                     | 162/266 [02:00<01:08,  1.51it/s]Train:  61%|█████████████████████████████████                     | 163/266 [02:01<01:17,  1.33it/s]Train:  62%|█████████████████████████████████▎                    | 164/266 [02:02<01:12,  1.42it/s]Train:  62%|█████████████████████████████████▍                    | 165/266 [02:03<01:20,  1.26it/s]Train:  62%|█████████████████████████████████▋                    | 166/266 [02:04<01:23,  1.19it/s]Train:  63%|█████████████████████████████████▉                    | 167/266 [02:05<01:28,  1.11it/s]Train:  63%|██████████████████████████████████                    | 168/266 [02:05<01:20,  1.21it/s]Train:  64%|██████████████████████████████████▎                   | 169/266 [02:06<01:20,  1.21it/s]Train:  64%|██████████████████████████████████▌                   | 170/266 [02:07<01:15,  1.27it/s]Train:  64%|██████████████████████████████████▋                   | 171/266 [02:08<01:08,  1.38it/s]Train:  65%|██████████████████████████████████▉                   | 172/266 [02:08<01:09,  1.35it/s]Train:  65%|███████████████████████████████████                   | 173/266 [02:09<01:18,  1.19it/s]Train:  65%|███████████████████████████████████▎                  | 174/266 [02:10<01:15,  1.23it/s]Train:  66%|███████████████████████████████████▌                  | 175/266 [02:11<01:11,  1.27it/s]Train:  66%|███████████████████████████████████▋                  | 176/266 [02:11<01:03,  1.41it/s]Train:  67%|███████████████████████████████████▉                  | 177/266 [02:12<00:57,  1.54it/s]Train:  67%|████████████████████████████████████▏                 | 178/266 [02:12<00:53,  1.65it/s]Train:  67%|████████████████████████████████████▎                 | 179/266 [02:13<01:02,  1.39it/s]Train:  68%|████████████████████████████████████▌                 | 180/266 [02:14<00:58,  1.47it/s]Train:  68%|████████████████████████████████████▋                 | 181/266 [02:15<00:57,  1.47it/s]Train:  68%|████████████████████████████████████▉                 | 182/266 [02:16<01:00,  1.39it/s]Train:  69%|█████████████████████████████████████▏                | 183/266 [02:16<01:01,  1.35it/s]Train:  69%|█████████████████████████████████████▎                | 184/266 [02:17<01:03,  1.29it/s]Train:  70%|█████████████████████████████████████▌                | 185/266 [02:18<01:11,  1.13it/s]Train:  70%|█████████████████████████████████████▊                | 186/266 [02:19<01:10,  1.13it/s]Train:  70%|█████████████████████████████████████▉                | 187/266 [02:20<01:03,  1.24it/s]Train:  71%|██████████████████████████████████████▏               | 188/266 [02:21<01:09,  1.12it/s]Train:  71%|██████████████████████████████████████▎               | 189/266 [02:22<01:04,  1.20it/s]Train:  71%|██████████████████████████████████████▌               | 190/266 [02:22<00:57,  1.31it/s]Train:  72%|██████████████████████████████████████▊               | 191/266 [02:23<01:04,  1.15it/s]Train:  72%|██████████████████████████████████████▉               | 192/266 [02:24<00:57,  1.29it/s]Train:  73%|███████████████████████████████████████▏              | 193/266 [02:25<00:57,  1.27it/s]Train:  73%|███████████████████████████████████████▍              | 194/266 [02:25<00:55,  1.31it/s]Train:  73%|███████████████████████████████████████▌              | 195/266 [02:26<00:56,  1.25it/s]Train:  74%|███████████████████████████████████████▊              | 196/266 [02:27<00:53,  1.30it/s]Train:  74%|███████████████████████████████████████▉              | 197/266 [02:28<00:52,  1.30it/s]Train:  74%|████████████████████████████████████████▏             | 198/266 [02:28<00:47,  1.44it/s]Train:  75%|████████████████████████████████████████▍             | 199/266 [02:29<00:49,  1.35it/s]Train:  75%|████████████████████████████████████████▌             | 200/266 [02:30<00:48,  1.37it/s]Train:  76%|████████████████████████████████████████▊             | 201/266 [02:31<00:50,  1.29it/s]Train:  76%|█████████████████████████████████████████             | 202/266 [02:31<00:46,  1.37it/s]Train:  76%|█████████████████████████████████████████▏            | 203/266 [02:32<00:41,  1.51it/s]Train:  77%|█████████████████████████████████████████▍            | 204/266 [02:32<00:40,  1.52it/s]Train:  77%|█████████████████████████████████████████▌            | 205/266 [02:33<00:45,  1.35it/s]Train:  77%|█████████████████████████████████████████▊            | 206/266 [02:34<00:42,  1.40it/s]Train:  78%|██████████████████████████████████████████            | 207/266 [02:35<00:43,  1.34it/s]Train:  78%|██████████████████████████████████████████▏           | 208/266 [02:36<00:43,  1.34it/s]Train:  79%|██████████████████████████████████████████▍           | 209/266 [02:36<00:41,  1.37it/s]Train:  79%|██████████████████████████████████████████▋           | 210/266 [02:37<00:39,  1.41it/s]Train:  79%|██████████████████████████████████████████▊           | 211/266 [02:38<00:41,  1.34it/s]Train:  80%|███████████████████████████████████████████           | 212/266 [02:38<00:37,  1.45it/s]Train:  80%|███████████████████████████████████████████▏          | 213/266 [02:39<00:34,  1.54it/s]Train:  80%|███████████████████████████████████████████▍          | 214/266 [02:40<00:36,  1.41it/s]Train:  81%|███████████████████████████████████████████▋          | 215/266 [02:41<00:39,  1.30it/s]Train:  81%|███████████████████████████████████████████▊          | 216/266 [02:41<00:36,  1.38it/s]Train:  82%|████████████████████████████████████████████          | 217/266 [02:42<00:39,  1.25it/s]Train:  82%|████████████████████████████████████████████▎         | 218/266 [02:43<00:38,  1.24it/s]Train:  82%|████████████████████████████████████████████▍         | 219/266 [02:44<00:34,  1.36it/s]Train:  83%|████████████████████████████████████████████▋         | 220/266 [02:44<00:32,  1.43it/s]Train:  83%|████████████████████████████████████████████▊         | 221/266 [02:45<00:30,  1.49it/s]Train:  83%|█████████████████████████████████████████████         | 222/266 [02:46<00:32,  1.35it/s]Train:  84%|█████████████████████████████████████████████▎        | 223/266 [02:46<00:30,  1.40it/s]Train:  84%|█████████████████████████████████████████████▍        | 224/266 [02:47<00:32,  1.30it/s]Train:  85%|█████████████████████████████████████████████▋        | 225/266 [02:48<00:29,  1.38it/s]Train:  85%|█████████████████████████████████████████████▉        | 226/266 [02:49<00:33,  1.20it/s]Train:  85%|██████████████████████████████████████████████        | 227/266 [02:50<00:30,  1.28it/s]Train:  86%|██████████████████████████████████████████████▎       | 228/266 [02:51<00:31,  1.19it/s]Train:  86%|██████████████████████████████████████████████▍       | 229/266 [02:51<00:29,  1.25it/s]Train:  86%|██████████████████████████████████████████████▋       | 230/266 [02:52<00:27,  1.29it/s]Train:  87%|██████████████████████████████████████████████▉       | 231/266 [02:53<00:30,  1.15it/s]Train:  87%|███████████████████████████████████████████████       | 232/266 [02:54<00:29,  1.16it/s]Train:  88%|███████████████████████████████████████████████▎      | 233/266 [02:55<00:30,  1.08it/s]Train:  88%|███████████████████████████████████████████████▌      | 234/266 [02:56<00:26,  1.20it/s]Train:  88%|███████████████████████████████████████████████▋      | 235/266 [02:57<00:25,  1.22it/s]Train:  89%|███████████████████████████████████████████████▉      | 236/266 [02:57<00:23,  1.30it/s]Train:  89%|████████████████████████████████████████████████      | 237/266 [02:58<00:23,  1.25it/s]Train:  89%|████████████████████████████████████████████████▎     | 238/266 [02:59<00:20,  1.33it/s]Train:  90%|████████████████████████████████████████████████▌     | 239/266 [03:00<00:22,  1.17it/s]Train:  90%|████████████████████████████████████████████████▋     | 240/266 [03:00<00:20,  1.28it/s]Train:  91%|████████████████████████████████████████████████▉     | 241/266 [03:01<00:18,  1.36it/s]Train:  91%|█████████████████████████████████████████████████▏    | 242/266 [03:02<00:17,  1.41it/s]Train:  91%|█████████████████████████████████████████████████▎    | 243/266 [03:02<00:16,  1.39it/s]Train:  92%|█████████████████████████████████████████████████▌    | 244/266 [03:03<00:17,  1.27it/s]Train:  92%|█████████████████████████████████████████████████▋    | 245/266 [03:04<00:15,  1.33it/s]Train:  92%|█████████████████████████████████████████████████▉    | 246/266 [03:05<00:14,  1.35it/s]Train:  93%|██████████████████████████████████████████████████▏   | 247/266 [03:05<00:13,  1.39it/s]Train:  93%|██████████████████████████████████████████████████▎   | 248/266 [03:07<00:15,  1.19it/s]Train:  94%|██████████████████████████████████████████████████▌   | 249/266 [03:08<00:15,  1.10it/s]Train:  94%|██████████████████████████████████████████████████▊   | 250/266 [03:09<00:15,  1.04it/s]Train:  94%|██████████████████████████████████████████████████▉   | 251/266 [03:09<00:13,  1.14it/s]Train:  95%|███████████████████████████████████████████████████▏  | 252/266 [03:10<00:13,  1.06it/s]Train:  95%|███████████████████████████████████████████████████▎  | 253/266 [03:11<00:11,  1.10it/s]Train:  95%|███████████████████████████████████████████████████▌  | 254/266 [03:12<00:10,  1.14it/s]Train:  96%|███████████████████████████████████████████████████▊  | 255/266 [03:13<00:09,  1.14it/s]Train:  96%|███████████████████████████████████████████████████▉  | 256/266 [03:14<00:07,  1.27it/s]Train:  97%|████████████████████████████████████████████████████▏ | 257/266 [03:15<00:08,  1.12it/s]Train:  97%|████████████████████████████████████████████████████▍ | 258/266 [03:15<00:06,  1.22it/s]Train:  97%|████████████████████████████████████████████████████▌ | 259/266 [03:16<00:05,  1.30it/s]Train:  98%|████████████████████████████████████████████████████▊ | 260/266 [03:17<00:04,  1.30it/s]Train:  98%|████████████████████████████████████████████████████▉ | 261/266 [03:17<00:03,  1.40it/s]Train:  98%|█████████████████████████████████████████████████████▏| 262/266 [03:18<00:03,  1.33it/s]Train:  99%|█████████████████████████████████████████████████████▍| 263/266 [03:19<00:02,  1.41it/s]Train:  99%|█████████████████████████████████████████████████████▌| 264/266 [03:20<00:01,  1.35it/s]Train: 100%|█████████████████████████████████████████████████████▊| 265/266 [03:21<00:00,  1.16it/s]Train: 100%|██████████████████████████████████████████████████████| 266/266 [03:21<00:00,  1.55it/s]                                                                                                    201.48 seconds
Validation:   0%|                                                            | 0/30 [00:00<?, ?it/s]Validation:   3%|█▋                                                  | 1/30 [00:02<01:02,  2.16s/it]                                                                                                    Traceback (most recent call last):
  File "/root/SMoP/scripts/train.py", line 618, in <module>
    train(args)
  File "/root/SMoP/scripts/train.py", line 238, in train
    val_loss, preds, answers = evaluate_epoch(model, scaler, val_dataloader, device, tokenizer, text_to_text, test=False)
  File "/root/SMoP/scripts/train.py", line 440, in evaluate_epoch
    outputs = model(input_ids=input_ids, attention_mask=att_mask, labels=labels, output_attentions=True)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/SMoP/peft_models/peft_model.py", line 795, in forward
    return self.base_model(input_ids=input_ids, decoder_input_ids=decoder_input_ids, past_key_values=past_prompt, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/SMoP/src/t5_with_encoder_prefix.py", line 83, in forward
    encoder_outputs = self.encoder(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 1106, in forward
    layer_outputs = layer_module(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 686, in forward
    self_attention_outputs = self.layer[0](
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 593, in forward
    attention_output = self.SelfAttention(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 553, in forward
    attn_weights = nn.functional.softmax(scores.float(), dim=-1).type_as(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/functional.py", line 1858, in softmax
    ret = input.softmax(dim)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 186.00 MiB. GPU 0 has a total capacity of 23.68 GiB of which 48.81 MiB is free. Process 758017 has 6.94 GiB memory in use. Process 758018 has 9.66 GiB memory in use. Process 758019 has 7.00 GiB memory in use. Of the allocated memory 9.03 GiB is allocated by PyTorch, and 326.08 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
