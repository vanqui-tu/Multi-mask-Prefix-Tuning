Namespace(seed=None, subsetlr=0.05, lr=0.005, warmup_ratio=0.06, batch_size=32, step_batch_size=None, epoch=30, max_length=512, weight_decay=0, dataset_name='boolq', model_name_or_path='t5-base', tokenizer_name_or_path='t5-base', random_seed=42, method='prefix-routing', num_virtual_tokens=1, num_shared_virtual_tokens=10, num_virtual_tokens_full=8, routing_level='prompt', consistency_alpha=0.1, init_copy=True, perturb_router=1, topk=1, stochastic=False, gumbel=False, shareType='Only', sharedEmbeddinglr=0.005, routerlr=0.0005, apply_adaptive_mask=1, apply_adaptive_subset_mask=1)
lr=0.005 batch_size=32 epoch=30 num_virtual_tokens=1 random_seed=42
Formatting dataset:   0%|                                                  | 0/8483 [00:00<?, ?it/s]Formatting dataset:   1%|▍                                       | 99/8483 [00:00<00:08, 987.02it/s]Formatting dataset:   2%|▉                                     | 208/8483 [00:00<00:07, 1047.28it/s]Formatting dataset:   4%|█▍                                    | 320/8483 [00:00<00:07, 1079.92it/s]Formatting dataset:   5%|█▉                                    | 436/8483 [00:00<00:07, 1111.37it/s]Formatting dataset:   7%|██▍                                   | 558/8483 [00:00<00:06, 1147.28it/s]Formatting dataset:   8%|███                                   | 673/8483 [00:00<00:06, 1147.55it/s]Formatting dataset:   9%|███▌                                  | 797/8483 [00:00<00:06, 1175.85it/s]Formatting dataset:  11%|████                                  | 920/8483 [00:00<00:06, 1190.43it/s]Formatting dataset:  12%|████▌                                | 1042/8483 [00:00<00:06, 1196.57it/s]Formatting dataset:  14%|█████                                | 1162/8483 [00:01<00:06, 1192.58it/s]Formatting dataset:  15%|█████▌                               | 1282/8483 [00:01<00:06, 1176.07it/s]Formatting dataset:  17%|██████                               | 1400/8483 [00:01<00:06, 1156.11it/s]Formatting dataset:  18%|██████▌                              | 1516/8483 [00:01<00:06, 1148.10it/s]Formatting dataset:  19%|███████▏                             | 1636/8483 [00:01<00:05, 1162.79it/s]Formatting dataset:  21%|███████▋                             | 1754/8483 [00:01<00:05, 1167.16it/s]Formatting dataset:  22%|████████▏                            | 1871/8483 [00:01<00:05, 1163.03it/s]Formatting dataset:  23%|████████▋                            | 1991/8483 [00:01<00:05, 1172.07it/s]Formatting dataset:  25%|█████████▏                           | 2110/8483 [00:01<00:05, 1174.52it/s]Formatting dataset:  26%|█████████▋                           | 2228/8483 [00:01<00:05, 1173.12it/s]Formatting dataset:  28%|██████████▎                          | 2351/8483 [00:02<00:05, 1186.48it/s]Formatting dataset:  29%|██████████▊                          | 2470/8483 [00:02<00:05, 1183.27it/s]Formatting dataset:  31%|███████████▎                         | 2589/8483 [00:02<00:05, 1173.34it/s]Formatting dataset:  32%|███████████▊                         | 2707/8483 [00:02<00:04, 1173.01it/s]Formatting dataset:  33%|████████████▎                        | 2827/8483 [00:02<00:04, 1178.63it/s]Formatting dataset:  35%|████████████▊                        | 2945/8483 [00:02<00:04, 1170.71it/s]Formatting dataset:  36%|█████████████▎                       | 3063/8483 [00:02<00:04, 1165.86it/s]Formatting dataset:  37%|█████████████▊                       | 3181/8483 [00:02<00:04, 1169.30it/s]Formatting dataset:  39%|██████████████▍                      | 3298/8483 [00:02<00:04, 1153.91it/s]Formatting dataset:  40%|██████████████▉                      | 3414/8483 [00:02<00:04, 1131.93it/s]Formatting dataset:  42%|███████████████▍                     | 3537/8483 [00:03<00:04, 1158.10it/s]Formatting dataset:  43%|███████████████▉                     | 3653/8483 [00:03<00:04, 1154.68it/s]Formatting dataset:  44%|████████████████▍                    | 3772/8483 [00:03<00:04, 1161.63it/s]Formatting dataset:  46%|████████████████▉                    | 3894/8483 [00:03<00:03, 1175.36it/s]Formatting dataset:  47%|█████████████████▍                   | 4012/8483 [00:03<00:03, 1151.91it/s]Formatting dataset:  49%|██████████████████                   | 4128/8483 [00:03<00:03, 1137.51it/s]Formatting dataset:  50%|██████████████████▌                  | 4242/8483 [00:03<00:03, 1136.13it/s]Formatting dataset:  51%|██████████████████▉                  | 4356/8483 [00:03<00:03, 1112.98it/s]Formatting dataset:  53%|███████████████████▌                 | 4477/8483 [00:03<00:03, 1139.29it/s]Formatting dataset:  54%|████████████████████                 | 4596/8483 [00:03<00:03, 1153.23it/s]Formatting dataset:  56%|████████████████████▌                | 4712/8483 [00:04<00:03, 1144.47it/s]Formatting dataset:  57%|█████████████████████                | 4828/8483 [00:04<00:03, 1146.74it/s]Formatting dataset:  58%|█████████████████████▌               | 4944/8483 [00:04<00:03, 1150.19it/s]Formatting dataset:  60%|██████████████████████               | 5064/8483 [00:04<00:02, 1159.52it/s]Formatting dataset:  61%|██████████████████████▌              | 5180/8483 [00:04<00:02, 1151.69it/s]Formatting dataset:  62%|███████████████████████              | 5296/8483 [00:04<00:02, 1138.98it/s]Formatting dataset:  64%|███████████████████████▌             | 5412/8483 [00:04<00:02, 1142.46it/s]Formatting dataset:  65%|████████████████████████             | 5529/8483 [00:04<00:02, 1148.25it/s]Formatting dataset:  67%|████████████████████████▌            | 5644/8483 [00:04<00:02, 1130.60it/s]Formatting dataset:  68%|█████████████████████████▏           | 5762/8483 [00:04<00:02, 1143.38it/s]Formatting dataset:  69%|█████████████████████████▋           | 5877/8483 [00:05<00:02, 1143.38it/s]Formatting dataset:  71%|██████████████████████████▏          | 6002/8483 [00:05<00:02, 1172.87it/s]Formatting dataset:  72%|██████████████████████████▋          | 6121/8483 [00:05<00:02, 1174.82it/s]Formatting dataset:  74%|███████████████████████████▏         | 6239/8483 [00:05<00:01, 1147.01it/s]Formatting dataset:  75%|███████████████████████████▋         | 6362/8483 [00:05<00:01, 1169.08it/s]Formatting dataset:  76%|████████████████████████████▎        | 6483/8483 [00:05<00:01, 1178.86it/s]Formatting dataset:  78%|████████████████████████████▊        | 6602/8483 [00:05<00:01, 1157.78it/s]Formatting dataset:  79%|█████████████████████████████▎       | 6718/8483 [00:05<00:01, 1146.95it/s]Formatting dataset:  81%|█████████████████████████████▊       | 6838/8483 [00:05<00:01, 1160.86it/s]Formatting dataset:  82%|██████████████████████████████▎      | 6956/8483 [00:06<00:01, 1166.47it/s]Formatting dataset:  83%|██████████████████████████████▊      | 7073/8483 [00:06<00:01, 1160.91it/s]Formatting dataset:  85%|███████████████████████████████▎     | 7190/8483 [00:06<00:01, 1153.42it/s]Formatting dataset:  86%|███████████████████████████████▊     | 7306/8483 [00:06<00:01, 1130.68it/s]Formatting dataset:  87%|████████████████████████████████▎    | 7421/8483 [00:06<00:00, 1135.35it/s]Formatting dataset:  89%|████████████████████████████████▊    | 7535/8483 [00:06<00:00, 1125.05it/s]Formatting dataset:  90%|█████████████████████████████████▍   | 7653/8483 [00:06<00:00, 1139.63it/s]Formatting dataset:  92%|█████████████████████████████████▉   | 7773/8483 [00:06<00:00, 1154.20it/s]Formatting dataset:  93%|██████████████████████████████████▍  | 7889/8483 [00:06<00:00, 1150.37it/s]Formatting dataset:  94%|██████████████████████████████████▉  | 8008/8483 [00:06<00:00, 1161.80it/s]Formatting dataset:  96%|███████████████████████████████████▍ | 8125/8483 [00:07<00:00, 1131.67it/s]Formatting dataset:  97%|███████████████████████████████████▉ | 8240/8483 [00:07<00:00, 1135.48it/s]Formatting dataset:  99%|████████████████████████████████████▍| 8361/8483 [00:07<00:00, 1155.10it/s]Formatting dataset: 100%|████████████████████████████████████▉| 8480/8483 [00:07<00:00, 1162.93it/s]Formatting dataset: 100%|█████████████████████████████████████| 8483/8483 [00:07<00:00, 1154.35it/s]
Formatting dataset:   0%|                                                   | 0/944 [00:00<?, ?it/s]Formatting dataset:  13%|████▉                                  | 120/944 [00:00<00:00, 1199.01it/s]Formatting dataset:  26%|██████████                             | 243/944 [00:00<00:00, 1216.09it/s]Formatting dataset:  39%|███████████████                        | 365/944 [00:00<00:00, 1176.18it/s]Formatting dataset:  52%|████████████████████▍                  | 494/944 [00:00<00:00, 1217.21it/s]Formatting dataset:  65%|█████████████████████████▍             | 616/944 [00:00<00:00, 1185.17it/s]Formatting dataset:  78%|██████████████████████████████▎        | 735/944 [00:00<00:00, 1166.89it/s]Formatting dataset:  90%|███████████████████████████████████▏   | 852/944 [00:00<00:00, 1159.29it/s]Formatting dataset: 100%|███████████████████████████████████████| 944/944 [00:00<00:00, 1165.64it/s]
Formatting dataset:   0%|                                                  | 0/3270 [00:00<?, ?it/s]Formatting dataset:   4%|█▎                                    | 116/3270 [00:00<00:02, 1156.07it/s]Formatting dataset:   7%|██▋                                   | 232/3270 [00:00<00:02, 1133.12it/s]Formatting dataset:  11%|████                                  | 348/3270 [00:00<00:02, 1143.92it/s]Formatting dataset:  14%|█████▍                                | 468/3270 [00:00<00:02, 1165.12it/s]Formatting dataset:  18%|██████▊                               | 587/3270 [00:00<00:02, 1173.71it/s]Formatting dataset:  22%|████████▏                             | 705/3270 [00:00<00:02, 1164.79it/s]Formatting dataset:  25%|█████████▌                            | 827/3270 [00:00<00:02, 1181.89it/s]Formatting dataset:  29%|██████████▉                           | 946/3270 [00:00<00:02, 1160.34it/s]Formatting dataset:  33%|████████████                         | 1063/3270 [00:00<00:01, 1156.05it/s]Formatting dataset:  36%|█████████████▍                       | 1183/3270 [00:01<00:01, 1166.05it/s]Formatting dataset:  40%|██████████████▋                      | 1300/3270 [00:01<00:01, 1116.93it/s]Formatting dataset:  43%|███████████████▉                     | 1413/3270 [00:01<00:01, 1115.85it/s]Formatting dataset:  47%|█████████████████▎                   | 1530/3270 [00:01<00:01, 1130.66it/s]Formatting dataset:  50%|██████████████████▋                  | 1650/3270 [00:01<00:01, 1149.29it/s]Formatting dataset:  54%|███████████████████▉                 | 1766/3270 [00:01<00:01, 1132.80it/s]Formatting dataset:  58%|█████████████████████▎               | 1882/3270 [00:01<00:01, 1140.43it/s]Formatting dataset:  61%|██████████████████████▌              | 1997/3270 [00:01<00:01, 1138.29it/s]Formatting dataset:  65%|███████████████████████▉             | 2114/3270 [00:01<00:01, 1146.80it/s]Formatting dataset:  68%|█████████████████████████▏           | 2229/3270 [00:01<00:00, 1139.23it/s]Formatting dataset:  72%|██████████████████████████▌          | 2343/3270 [00:02<00:00, 1136.54it/s]Formatting dataset:  75%|███████████████████████████▊         | 2457/3270 [00:02<00:00, 1136.86it/s]Formatting dataset:  79%|█████████████████████████████▏       | 2578/3270 [00:02<00:00, 1156.26it/s]Formatting dataset:  82%|██████████████████████████████▍      | 2694/3270 [00:02<00:00, 1145.03it/s]Formatting dataset:  86%|███████████████████████████████▊     | 2817/3270 [00:02<00:00, 1168.01it/s]Formatting dataset:  90%|█████████████████████████████████▏   | 2934/3270 [00:02<00:00, 1152.88it/s]Formatting dataset:  93%|██████████████████████████████████▌  | 3052/3270 [00:02<00:00, 1159.94it/s]Formatting dataset:  97%|███████████████████████████████████▊ | 3169/3270 [00:02<00:00, 1147.53it/s]Formatting dataset: 100%|█████████████████████████████████████| 3270/3270 [00:02<00:00, 1147.94it/s]
prompt_encoder.mask 960
prompt_encoder.embedding.weight 147456
prompt_encoder.sharedEmbedding.weight 184320
prompt_encoder.router.0.weight 6144
trainable params: 338880 || all params: 223220928 || trainable%: 0.15181372241226415
Train:   0%|                                                                | 0/266 [00:00<?, ?it/s]Train:   0%|▏                                                       | 1/266 [00:01<06:09,  1.40s/it]Train:   1%|▍                                                       | 2/266 [00:01<03:26,  1.28it/s]Train:   1%|▋                                                       | 3/266 [00:02<03:18,  1.33it/s]Train:   2%|▊                                                       | 4/266 [00:02<02:44,  1.59it/s]Train:   2%|█                                                       | 5/266 [00:03<02:25,  1.79it/s]Train:   2%|█▎                                                      | 6/266 [00:03<02:22,  1.82it/s]Train:   3%|█▍                                                      | 7/266 [00:04<02:28,  1.75it/s]Train:   3%|█▋                                                      | 8/266 [00:05<02:39,  1.62it/s]Train:   3%|█▉                                                      | 9/266 [00:05<02:39,  1.61it/s]Train:   4%|██                                                     | 10/266 [00:06<02:49,  1.51it/s]Train:   4%|██▎                                                    | 11/266 [00:07<02:48,  1.52it/s]Train:   5%|██▍                                                    | 12/266 [00:07<02:24,  1.75it/s]Train:   5%|██▋                                                    | 13/266 [00:08<02:15,  1.87it/s]Train:   5%|██▉                                                    | 14/266 [00:08<02:01,  2.07it/s]Train:   6%|███                                                    | 15/266 [00:08<01:53,  2.20it/s]Train:   6%|███▎                                                   | 16/266 [00:09<02:00,  2.07it/s]Train:   6%|███▌                                                   | 17/266 [00:10<02:21,  1.77it/s]Train:   7%|███▋                                                   | 18/266 [00:10<02:11,  1.88it/s]Train:   7%|███▉                                                   | 19/266 [00:11<02:06,  1.95it/s]Train:   8%|████▏                                                  | 20/266 [00:11<02:00,  2.05it/s]Train:   8%|████▎                                                  | 21/266 [00:11<01:53,  2.16it/s]Train:   8%|████▌                                                  | 22/266 [00:12<01:50,  2.20it/s]Train:   9%|████▊                                                  | 23/266 [00:12<01:50,  2.21it/s]Train:   9%|████▉                                                  | 24/266 [00:13<01:44,  2.32it/s]Train:   9%|█████▏                                                 | 25/266 [00:13<01:47,  2.24it/s]Train:  10%|█████▍                                                 | 26/266 [00:14<01:50,  2.17it/s]Train:  10%|█████▌                                                 | 27/266 [00:14<01:59,  1.99it/s]Train:  11%|█████▊                                                 | 28/266 [00:15<02:09,  1.84it/s]Train:  11%|█████▉                                                 | 29/266 [00:15<02:01,  1.95it/s]Train:  11%|██████▏                                                | 30/266 [00:16<02:04,  1.90it/s]Train:  12%|██████▍                                                | 31/266 [00:16<01:58,  1.98it/s]Train:  12%|██████▌                                                | 32/266 [00:17<01:51,  2.10it/s]Train:  12%|██████▊                                                | 33/266 [00:17<02:02,  1.91it/s]Train:  13%|███████                                                | 34/266 [00:18<02:16,  1.71it/s]Train:  13%|███████▏                                               | 35/266 [00:19<02:05,  1.84it/s]Train:  14%|███████▍                                               | 36/266 [00:19<01:55,  1.99it/s]Train:  14%|███████▋                                               | 37/266 [00:20<02:10,  1.76it/s]Train:  14%|███████▊                                               | 38/266 [00:20<01:58,  1.93it/s]Train:  15%|████████                                               | 39/266 [00:21<02:14,  1.69it/s]Train:  15%|████████▎                                              | 40/266 [00:21<01:56,  1.94it/s]Train:  15%|████████▍                                              | 41/266 [00:22<02:12,  1.70it/s]Train:  16%|████████▋                                              | 42/266 [00:22<02:02,  1.83it/s]Train:  16%|████████▉                                              | 43/266 [00:23<01:55,  1.92it/s]Train:  17%|█████████                                              | 44/266 [00:23<01:57,  1.88it/s]Train:  17%|█████████▎                                             | 45/266 [00:24<02:03,  1.80it/s]Train:  17%|█████████▌                                             | 46/266 [00:25<01:59,  1.83it/s]Train:  18%|█████████▋                                             | 47/266 [00:25<01:52,  1.94it/s]Train:  18%|█████████▉                                             | 48/266 [00:25<01:47,  2.03it/s]Train:  18%|██████████▏                                            | 49/266 [00:26<02:04,  1.74it/s]Train:  19%|██████████▎                                            | 50/266 [00:27<01:54,  1.88it/s]Train:  19%|██████████▌                                            | 51/266 [00:27<01:56,  1.85it/s]Train:  20%|██████████▊                                            | 52/266 [00:28<01:46,  2.02it/s]Train:  20%|██████████▉                                            | 53/266 [00:28<01:54,  1.87it/s]Train:  20%|███████████▏                                           | 54/266 [00:29<01:53,  1.87it/s]Train:  21%|███████████▎                                           | 55/266 [00:29<01:56,  1.81it/s]Train:  21%|███████████▌                                           | 56/266 [00:30<01:59,  1.75it/s]Train:  21%|███████████▊                                           | 57/266 [00:30<01:52,  1.86it/s]Train:  22%|███████████▉                                           | 58/266 [00:31<01:55,  1.80it/s]Train:  22%|████████████▏                                          | 59/266 [00:31<01:40,  2.05it/s]Train:  23%|████████████▍                                          | 60/266 [00:32<01:33,  2.20it/s]Train:  23%|████████████▌                                          | 61/266 [00:32<01:52,  1.82it/s]Train:  23%|████████████▊                                          | 62/266 [00:33<02:04,  1.64it/s]Train:  24%|█████████████                                          | 63/266 [00:34<01:50,  1.84it/s]Train:  24%|█████████████▏                                         | 64/266 [00:34<01:52,  1.80it/s]Train:  24%|█████████████▍                                         | 65/266 [00:35<02:02,  1.64it/s]Train:  25%|█████████████▋                                         | 66/266 [00:35<01:52,  1.78it/s]Train:  25%|█████████████▊                                         | 67/266 [00:36<02:02,  1.62it/s]Train:  26%|██████████████                                         | 68/266 [00:36<01:46,  1.85it/s]Train:  26%|██████████████▎                                        | 69/266 [00:37<01:50,  1.78it/s]Train:  26%|██████████████▍                                        | 70/266 [00:38<01:46,  1.83it/s]Train:  27%|██████████████▋                                        | 71/266 [00:38<01:32,  2.11it/s]Train:  27%|██████████████▉                                        | 72/266 [00:39<01:47,  1.80it/s]Train:  27%|███████████████                                        | 73/266 [00:39<01:50,  1.74it/s]Train:  28%|███████████████▎                                       | 74/266 [00:40<01:42,  1.87it/s]Train:  28%|███████████████▌                                       | 75/266 [00:40<01:53,  1.69it/s]Train:  29%|███████████████▋                                       | 76/266 [00:41<02:00,  1.58it/s]Train:  29%|███████████████▉                                       | 77/266 [00:42<01:51,  1.69it/s]Train:  29%|████████████████▏                                      | 78/266 [00:42<02:00,  1.56it/s]Train:  30%|████████████████▎                                      | 79/266 [00:43<01:41,  1.84it/s]Train:  30%|████████████████▌                                      | 80/266 [00:43<01:53,  1.64it/s]Train:  30%|████████████████▋                                      | 81/266 [00:44<01:40,  1.83it/s]Train:  31%|████████████████▉                                      | 82/266 [00:44<01:36,  1.91it/s]Train:  31%|█████████████████▏                                     | 83/266 [00:45<01:32,  1.97it/s]Train:  32%|█████████████████▎                                     | 84/266 [00:45<01:21,  2.24it/s]Train:  32%|█████████████████▌                                     | 85/266 [00:46<01:34,  1.92it/s]Train:  32%|█████████████████▊                                     | 86/266 [00:46<01:39,  1.81it/s]Train:  33%|█████████████████▉                                     | 87/266 [00:47<01:29,  1.99it/s]Train:  33%|██████████████████▏                                    | 88/266 [00:47<01:28,  2.00it/s]Train:  33%|██████████████████▍                                    | 89/266 [00:48<01:29,  1.98it/s]Train:  34%|██████████████████▌                                    | 90/266 [00:48<01:23,  2.11it/s]Train:  34%|██████████████████▊                                    | 91/266 [00:49<01:21,  2.14it/s]Train:  35%|███████████████████                                    | 92/266 [00:49<01:18,  2.21it/s]Train:  35%|███████████████████▏                                   | 93/266 [00:50<01:32,  1.87it/s]Train:  35%|███████████████████▍                                   | 94/266 [00:50<01:34,  1.82it/s]Train:  36%|███████████████████▋                                   | 95/266 [00:51<01:34,  1.81it/s]Train:  36%|███████████████████▊                                   | 96/266 [00:51<01:29,  1.89it/s]Train:  36%|████████████████████                                   | 97/266 [00:52<01:26,  1.96it/s]Train:  37%|████████████████████▎                                  | 98/266 [00:52<01:20,  2.09it/s]Train:  37%|████████████████████▍                                  | 99/266 [00:53<01:18,  2.13it/s]Train:  38%|████████████████████▎                                 | 100/266 [00:53<01:18,  2.11it/s]Train:  38%|████████████████████▌                                 | 101/266 [00:54<01:32,  1.79it/s]Train:  38%|████████████████████▋                                 | 102/266 [00:55<01:31,  1.79it/s]Train:  39%|████████████████████▉                                 | 103/266 [00:55<01:25,  1.91it/s]Train:  39%|█████████████████████                                 | 104/266 [00:55<01:17,  2.08it/s]Train:  39%|█████████████████████▎                                | 105/266 [00:56<01:18,  2.05it/s]Train:  40%|█████████████████████▌                                | 106/266 [00:56<01:19,  2.02it/s]Train:  40%|█████████████████████▋                                | 107/266 [00:57<01:13,  2.17it/s]Train:  41%|█████████████████████▉                                | 108/266 [00:57<01:20,  1.96it/s]Train:  41%|██████████████████████▏                               | 109/266 [00:58<01:15,  2.08it/s]Train:  41%|██████████████████████▎                               | 110/266 [00:58<01:18,  1.98it/s]Train:  42%|██████████████████████▌                               | 111/266 [00:59<01:21,  1.91it/s]Train:  42%|██████████████████████▋                               | 112/266 [01:00<01:24,  1.82it/s]Train:  42%|██████████████████████▉                               | 113/266 [01:00<01:28,  1.72it/s]Train:  43%|███████████████████████▏                              | 114/266 [01:01<01:20,  1.89it/s]Train:  43%|███████████████████████▎                              | 115/266 [01:01<01:14,  2.03it/s]Train:  44%|███████████████████████▌                              | 116/266 [01:02<01:16,  1.97it/s]Train:  44%|███████████████████████▊                              | 117/266 [01:02<01:10,  2.10it/s]Train:  44%|███████████████████████▉                              | 118/266 [01:03<01:16,  1.93it/s]Train:  45%|████████████████████████▏                             | 119/266 [01:03<01:12,  2.02it/s]Train:  45%|████████████████████████▎                             | 120/266 [01:03<01:09,  2.09it/s]Train:  45%|████████████████████████▌                             | 121/266 [01:04<01:20,  1.81it/s]Train:  46%|████████████████████████▊                             | 122/266 [01:05<01:12,  2.00it/s]Train:  46%|████████████████████████▉                             | 123/266 [01:05<01:13,  1.95it/s]Train:  47%|█████████████████████████▏                            | 124/266 [01:06<01:22,  1.71it/s]Train:  47%|█████████████████████████▍                            | 125/266 [01:06<01:14,  1.89it/s]Train:  47%|█████████████████████████▌                            | 126/266 [01:07<01:13,  1.90it/s]Train:  48%|█████████████████████████▊                            | 127/266 [01:07<01:09,  2.00it/s]Train:  48%|█████████████████████████▉                            | 128/266 [01:08<01:00,  2.26it/s]Train:  48%|██████████████████████████▏                           | 129/266 [01:08<00:57,  2.40it/s]Train:  49%|██████████████████████████▍                           | 130/266 [01:09<01:03,  2.13it/s]Train:  49%|██████████████████████████▌                           | 131/266 [01:09<00:58,  2.32it/s]Train:  50%|██████████████████████████▊                           | 132/266 [01:09<00:56,  2.38it/s]Train:  50%|███████████████████████████                           | 133/266 [01:10<00:54,  2.42it/s]Train:  50%|███████████████████████████▏                          | 134/266 [01:10<00:57,  2.31it/s]Train:  51%|███████████████████████████▍                          | 135/266 [01:11<01:01,  2.15it/s]Train:  51%|███████████████████████████▌                          | 136/266 [01:11<00:58,  2.23it/s]Train:  52%|███████████████████████████▊                          | 137/266 [01:12<00:58,  2.19it/s]Train:  52%|████████████████████████████                          | 138/266 [01:12<00:55,  2.30it/s]Train:  52%|████████████████████████████▏                         | 139/266 [01:12<00:57,  2.22it/s]Train:  53%|████████████████████████████▍                         | 140/266 [01:13<01:00,  2.09it/s]Train:  53%|████████████████████████████▌                         | 141/266 [01:13<00:58,  2.12it/s]Train:  53%|████████████████████████████▊                         | 142/266 [01:14<00:58,  2.14it/s]Train:  54%|█████████████████████████████                         | 143/266 [01:15<01:06,  1.84it/s]Train:  54%|█████████████████████████████▏                        | 144/266 [01:15<01:08,  1.77it/s]Train:  55%|█████████████████████████████▍                        | 145/266 [01:16<01:14,  1.62it/s]Train:  55%|█████████████████████████████▋                        | 146/266 [01:16<01:08,  1.75it/s]Train:  55%|█████████████████████████████▊                        | 147/266 [01:17<01:00,  1.98it/s]Train:  56%|██████████████████████████████                        | 148/266 [01:17<00:58,  2.03it/s]Train:  56%|██████████████████████████████▏                       | 149/266 [01:18<00:59,  1.95it/s]Train:  56%|██████████████████████████████▍                       | 150/266 [01:18<00:57,  2.03it/s]Train:  57%|██████████████████████████████▋                       | 151/266 [01:19<00:52,  2.20it/s]Train:  57%|██████████████████████████████▊                       | 152/266 [01:19<00:52,  2.17it/s]Train:  58%|███████████████████████████████                       | 153/266 [01:20<00:59,  1.92it/s]Train:  58%|███████████████████████████████▎                      | 154/266 [01:20<00:55,  2.03it/s]Train:  58%|███████████████████████████████▍                      | 155/266 [01:21<00:56,  1.96it/s]Train:  59%|███████████████████████████████▋                      | 156/266 [01:21<00:57,  1.91it/s]Train:  59%|███████████████████████████████▊                      | 157/266 [01:22<00:53,  2.05it/s]Train:  59%|████████████████████████████████                      | 158/266 [01:22<00:49,  2.19it/s]Train:  60%|████████████████████████████████▎                     | 159/266 [01:23<00:50,  2.10it/s]Train:  60%|████████████████████████████████▍                     | 160/266 [01:23<00:55,  1.91it/s]Train:  61%|████████████████████████████████▋                     | 161/266 [01:24<00:52,  2.02it/s]Train:  61%|████████████████████████████████▉                     | 162/266 [01:24<00:49,  2.11it/s]Train:  61%|█████████████████████████████████                     | 163/266 [01:25<00:51,  1.98it/s]Train:  62%|█████████████████████████████████▎                    | 164/266 [01:25<00:47,  2.14it/s]Train:  62%|█████████████████████████████████▍                    | 165/266 [01:25<00:46,  2.19it/s]Train:  62%|█████████████████████████████████▋                    | 166/266 [01:26<00:50,  1.98it/s]Train:  63%|█████████████████████████████████▉                    | 167/266 [01:27<00:54,  1.83it/s]Train:  63%|██████████████████████████████████                    | 168/266 [01:27<00:54,  1.81it/s]Train:  64%|██████████████████████████████████▎                   | 169/266 [01:28<00:53,  1.80it/s]Train:  64%|██████████████████████████████████▌                   | 170/266 [01:28<00:53,  1.80it/s]Train:  64%|██████████████████████████████████▋                   | 171/266 [01:29<00:48,  1.98it/s]Train:  65%|██████████████████████████████████▉                   | 172/266 [01:29<00:44,  2.14it/s]Train:  65%|███████████████████████████████████                   | 173/266 [01:30<00:45,  2.05it/s]Train:  65%|███████████████████████████████████▎                  | 174/266 [01:30<00:46,  1.98it/s]Train:  66%|███████████████████████████████████▌                  | 175/266 [01:31<00:45,  1.98it/s]Train:  66%|███████████████████████████████████▋                  | 176/266 [01:31<00:41,  2.16it/s]Train:  67%|███████████████████████████████████▉                  | 177/266 [01:32<00:39,  2.24it/s]Train:  67%|████████████████████████████████████▏                 | 178/266 [01:32<00:42,  2.10it/s]Train:  67%|████████████████████████████████████▎                 | 179/266 [01:33<00:42,  2.04it/s]Train:  68%|████████████████████████████████████▌                 | 180/266 [01:33<00:46,  1.84it/s]Train:  68%|████████████████████████████████████▋                 | 181/266 [01:34<00:51,  1.64it/s]Train:  68%|████████████████████████████████████▉                 | 182/266 [01:35<00:50,  1.65it/s]Train:  69%|█████████████████████████████████████▏                | 183/266 [01:35<00:46,  1.78it/s]Train:  69%|█████████████████████████████████████▎                | 184/266 [01:36<00:44,  1.84it/s]Train:  70%|█████████████████████████████████████▌                | 185/266 [01:36<00:41,  1.97it/s]Train:  70%|█████████████████████████████████████▊                | 186/266 [01:37<00:42,  1.88it/s]Train:  70%|█████████████████████████████████████▉                | 187/266 [01:37<00:43,  1.81it/s]Train:  71%|██████████████████████████████████████▏               | 188/266 [01:38<00:47,  1.63it/s]Train:  71%|██████████████████████████████████████▎               | 189/266 [01:39<00:49,  1.54it/s]Train:  71%|██████████████████████████████████████▌               | 190/266 [01:39<00:45,  1.68it/s]Train:  72%|██████████████████████████████████████▊               | 191/266 [01:39<00:38,  1.93it/s]Train:  72%|██████████████████████████████████████▉               | 192/266 [01:40<00:38,  1.90it/s]Train:  73%|███████████████████████████████████████▏              | 193/266 [01:40<00:35,  2.05it/s]Train:  73%|███████████████████████████████████████▍              | 194/266 [01:41<00:32,  2.23it/s]Train:  73%|███████████████████████████████████████▌              | 195/266 [01:41<00:32,  2.22it/s]Train:  74%|███████████████████████████████████████▊              | 196/266 [01:42<00:32,  2.16it/s]Train:  74%|███████████████████████████████████████▉              | 197/266 [01:42<00:28,  2.45it/s]Train:  74%|████████████████████████████████████████▏             | 198/266 [01:42<00:27,  2.46it/s]Train:  75%|████████████████████████████████████████▍             | 199/266 [01:43<00:29,  2.31it/s]Train:  75%|████████████████████████████████████████▌             | 200/266 [01:44<00:32,  2.04it/s]Train:  76%|████████████████████████████████████████▊             | 201/266 [01:44<00:31,  2.04it/s]Train:  76%|█████████████████████████████████████████             | 202/266 [01:44<00:30,  2.10it/s]Train:  76%|█████████████████████████████████████████▏            | 203/266 [01:45<00:30,  2.05it/s]Train:  77%|█████████████████████████████████████████▍            | 204/266 [01:45<00:29,  2.13it/s]Train:  77%|█████████████████████████████████████████▌            | 205/266 [01:46<00:27,  2.24it/s]Train:  77%|█████████████████████████████████████████▊            | 206/266 [01:46<00:30,  1.96it/s]Train:  78%|██████████████████████████████████████████            | 207/266 [01:47<00:28,  2.06it/s]Train:  78%|██████████████████████████████████████████▏           | 208/266 [01:47<00:27,  2.08it/s]Train:  79%|██████████████████████████████████████████▍           | 209/266 [01:48<00:26,  2.14it/s]Train:  79%|██████████████████████████████████████████▋           | 210/266 [01:48<00:25,  2.24it/s]Train:  79%|██████████████████████████████████████████▊           | 211/266 [01:49<00:24,  2.28it/s]Train:  80%|███████████████████████████████████████████           | 212/266 [01:49<00:25,  2.10it/s]Train:  80%|███████████████████████████████████████████▏          | 213/266 [01:50<00:25,  2.04it/s]Train:  80%|███████████████████████████████████████████▍          | 214/266 [01:50<00:25,  2.04it/s]Train:  81%|███████████████████████████████████████████▋          | 215/266 [01:51<00:25,  2.04it/s]Train:  81%|███████████████████████████████████████████▊          | 216/266 [01:51<00:23,  2.13it/s]Train:  82%|████████████████████████████████████████████          | 217/266 [01:52<00:23,  2.10it/s]Train:  82%|████████████████████████████████████████████▎         | 218/266 [01:52<00:24,  1.99it/s]Train:  82%|████████████████████████████████████████████▍         | 219/266 [01:53<00:25,  1.88it/s]Train:  83%|████████████████████████████████████████████▋         | 220/266 [01:53<00:25,  1.83it/s]Train:  83%|████████████████████████████████████████████▊         | 221/266 [01:54<00:27,  1.64it/s]Train:  83%|█████████████████████████████████████████████         | 222/266 [01:55<00:28,  1.56it/s]Train:  84%|█████████████████████████████████████████████▎        | 223/266 [01:55<00:24,  1.73it/s]Train:  84%|█████████████████████████████████████████████▍        | 224/266 [01:56<00:23,  1.80it/s]Train:  85%|█████████████████████████████████████████████▋        | 225/266 [01:56<00:21,  1.87it/s]Train:  85%|█████████████████████████████████████████████▉        | 226/266 [01:57<00:21,  1.85it/s]Train:  85%|██████████████████████████████████████████████        | 227/266 [01:57<00:22,  1.73it/s]Train:  86%|██████████████████████████████████████████████▎       | 228/266 [01:58<00:20,  1.89it/s]Train:  86%|██████████████████████████████████████████████▍       | 229/266 [01:58<00:19,  1.94it/s]Train:  86%|██████████████████████████████████████████████▋       | 230/266 [01:59<00:17,  2.11it/s]Train:  87%|██████████████████████████████████████████████▉       | 231/266 [01:59<00:16,  2.09it/s]Train:  87%|███████████████████████████████████████████████       | 232/266 [02:00<00:15,  2.22it/s]Train:  88%|███████████████████████████████████████████████▎      | 233/266 [02:00<00:15,  2.18it/s]Train:  88%|███████████████████████████████████████████████▌      | 234/266 [02:01<00:17,  1.81it/s]Train:  88%|███████████████████████████████████████████████▋      | 235/266 [02:01<00:17,  1.75it/s]Train:  89%|███████████████████████████████████████████████▉      | 236/266 [02:02<00:16,  1.84it/s]Train:  89%|████████████████████████████████████████████████      | 237/266 [02:03<00:17,  1.64it/s]Train:  89%|████████████████████████████████████████████████▎     | 238/266 [02:03<00:15,  1.82it/s]Train:  90%|████████████████████████████████████████████████▌     | 239/266 [02:04<00:15,  1.77it/s]Train:  90%|████████████████████████████████████████████████▋     | 240/266 [02:04<00:13,  1.99it/s]Train:  91%|████████████████████████████████████████████████▉     | 241/266 [02:04<00:11,  2.18it/s]Train:  91%|█████████████████████████████████████████████████▏    | 242/266 [02:05<00:11,  2.06it/s]Train:  91%|█████████████████████████████████████████████████▎    | 243/266 [02:05<00:10,  2.17it/s]Train:  92%|█████████████████████████████████████████████████▌    | 244/266 [02:06<00:11,  2.00it/s]Train:  92%|█████████████████████████████████████████████████▋    | 245/266 [02:06<00:10,  2.04it/s]Train:  92%|█████████████████████████████████████████████████▉    | 246/266 [02:07<00:09,  2.14it/s]Train:  93%|██████████████████████████████████████████████████▏   | 247/266 [02:07<00:08,  2.23it/s]Train:  93%|██████████████████████████████████████████████████▎   | 248/266 [02:08<00:08,  2.21it/s]Train:  94%|██████████████████████████████████████████████████▌   | 249/266 [02:08<00:08,  1.97it/s]Train:  94%|██████████████████████████████████████████████████▊   | 250/266 [02:09<00:07,  2.05it/s]Train:  94%|██████████████████████████████████████████████████▉   | 251/266 [02:09<00:06,  2.25it/s]Train:  95%|███████████████████████████████████████████████████▏  | 252/266 [02:10<00:06,  2.20it/s]Train:  95%|███████████████████████████████████████████████████▎  | 253/266 [02:10<00:06,  2.05it/s]Train:  95%|███████████████████████████████████████████████████▌  | 254/266 [02:11<00:06,  1.91it/s]Train:  96%|███████████████████████████████████████████████████▊  | 255/266 [02:11<00:05,  1.93it/s]Train:  96%|███████████████████████████████████████████████████▉  | 256/266 [02:12<00:04,  2.03it/s]Train:  97%|████████████████████████████████████████████████████▏ | 257/266 [02:12<00:04,  2.01it/s]Train:  97%|████████████████████████████████████████████████████▍ | 258/266 [02:12<00:03,  2.39it/s]Train:  97%|████████████████████████████████████████████████████▌ | 259/266 [02:13<00:02,  2.56it/s]Train:  98%|████████████████████████████████████████████████████▊ | 260/266 [02:13<00:02,  2.36it/s]Train:  98%|████████████████████████████████████████████████████▉ | 261/266 [02:14<00:01,  2.53it/s]Train:  98%|█████████████████████████████████████████████████████▏| 262/266 [02:14<00:02,  1.96it/s]Train:  99%|█████████████████████████████████████████████████████▍| 263/266 [02:15<00:01,  1.81it/s]Train:  99%|█████████████████████████████████████████████████████▌| 264/266 [02:16<00:01,  1.67it/s]Train: 100%|█████████████████████████████████████████████████████▊| 265/266 [02:16<00:00,  1.67it/s]Train: 100%|██████████████████████████████████████████████████████| 266/266 [02:16<00:00,  2.20it/s]                                                                                                    137.07 seconds
Validation:   0%|                                                            | 0/30 [00:00<?, ?it/s]Validation:   3%|█▋                                                  | 1/30 [00:01<00:33,  1.15s/it]Validation:   7%|███▍                                                | 2/30 [00:01<00:26,  1.06it/s]Validation:  10%|█████▏                                              | 3/30 [00:02<00:25,  1.06it/s]Validation:  13%|██████▉                                             | 4/30 [00:03<00:25,  1.01it/s]Validation:  17%|████████▋                                           | 5/30 [00:04<00:21,  1.14it/s]Validation:  20%|██████████▍                                         | 6/30 [00:05<00:20,  1.15it/s]Validation:  23%|████████████▏                                       | 7/30 [00:06<00:18,  1.23it/s]Validation:  27%|█████████████▊                                      | 8/30 [00:06<00:17,  1.23it/s]Validation:  30%|███████████████▌                                    | 9/30 [00:08<00:19,  1.07it/s]Validation:  33%|█████████████████                                  | 10/30 [00:08<00:17,  1.14it/s]Validation:  37%|██████████████████▋                                | 11/30 [00:10<00:18,  1.04it/s]Validation:  40%|████████████████████▍                              | 12/30 [00:11<00:17,  1.06it/s]Validation:  43%|██████████████████████                             | 13/30 [00:11<00:16,  1.06it/s]Validation:  47%|███████████████████████▊                           | 14/30 [00:13<00:16,  1.01s/it]                                                                                                    Traceback (most recent call last):
  File "/root/SMoP/scripts/train.py", line 618, in <module>
    train(args)
  File "/root/SMoP/scripts/train.py", line 238, in train
    val_loss, preds, answers = evaluate_epoch(model, scaler, val_dataloader, device, tokenizer, text_to_text, test=False)
  File "/root/SMoP/scripts/train.py", line 440, in evaluate_epoch
    outputs = model(input_ids=input_ids, attention_mask=att_mask, labels=labels, output_attentions=True)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/SMoP/peft_models/peft_model.py", line 795, in forward
    return self.base_model(input_ids=input_ids, decoder_input_ids=decoder_input_ids, past_key_values=past_prompt, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/SMoP/src/t5_with_encoder_prefix.py", line 83, in forward
    encoder_outputs = self.encoder(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 1106, in forward
    layer_outputs = layer_module(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 686, in forward
    self_attention_outputs = self.layer[0](
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 593, in forward
    attention_output = self.SelfAttention(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/opt/conda/lib/python3.10/site-packages/transformers/models/t5/modeling_t5.py", line 553, in forward
    attn_weights = nn.functional.softmax(scores.float(), dim=-1).type_as(
  File "/opt/conda/lib/python3.10/site-packages/torch/nn/functional.py", line 1858, in softmax
    ret = input.softmax(dim)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 384.00 MiB. GPU 0 has a total capacity of 23.68 GiB of which 221.75 MiB is free. Process 762154 has 12.40 GiB memory in use. Process 762155 has 11.03 GiB memory in use. Of the allocated memory 8.90 GiB is allocated by PyTorch, and 1.83 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
